{"title": "Install k3s and get the kubeconfig", "content": "<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"null\">sudo apt update\r\n\r\nadduser eramax\r\n\r\nusermod -aG sudo eramax\r\n\r\ncurl -sfL https://get.k3s.io | K3S_KUBECONFIG_MODE=\"644\" sh -\r\n\r\nkubectl get nodes\r\n\r\ncat /var/lib/rancher/k3s/server/node-token \r\n#Copy node token\r\n\r\nsudo kubectl create serviceaccount k8sadmin -n kube-system\r\n\r\nsudo kubectl create clusterrolebinding k8sadmin --clusterrole=cluster-admin --serviceaccount=kube-system:k8sadmin\r\n\r\nsudo kubectl -n kube-system describe secret $(sudo kubectl -n kube-system get secret | (grep k8sadmin || echo \"$_\") | awk '{print $1}') | grep token: | awk '{print $2}'\r\n#Copy user token\r\n\r\nip a\r\n#copy the ip\r\n\r\nkubectl config view --raw > config\r\n\r\nnano config\r\n\r\n#update the IP and user from default to k8sadmin in line number 10 under the context\r\n#Add this part to the users section\r\n- name: k8sadmin\r\n  user:\r\n    token: <user token which copied from above>\r\n\r\n#Copy the config file into your $HOME/.kube/config in your computer and then you can use kubectl\r\n\r\n\r\n</pre>\n<p> </p>\n", "slug": "install-k3s-and-getting-the-kubeconfig", "featuredImage": null, "date": "2020-03-29T10:27:54", "categories": ["cloud", "deployment", "DevOps", "Docker", "Hosting", "Kubernetes", "linux", "system admin", "VM"]}